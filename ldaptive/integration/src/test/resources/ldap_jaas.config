ldaptive {
  org.ldaptive.jaas.LdapLoginModule required
    ldapUrl="${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    hostnameVerifier="org.ldaptive.ssl.AnyHostnameVerifier{foo=test}"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    userFilter="(mail={0})"
    userRoleAttribute="departmentNumber"
    sslSocketFactory="{trustCertificates=classpath:/ldaptive.trust.crt}";
};

ldaptive-ssl {
  org.ldaptive.jaas.LdapLoginModule required
    ldapUrl="${ldapSslTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    ssl="true"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    userFilter="(mail={0})"
    userRoleAttribute="departmentNumber"
    sslSocketFactory="org.ldaptive.ssl.SingletonTLSSocketFactory{org.ldaptive.ssl.X509CredentialConfig{{trustCertificates=file:target/test-classes/ldaptive.trust.crt}}}";
};

ldaptive-random {
  org.ldaptive.jaas.LdapLoginModule required
    ldapUrl="ldap://ed-dne.middleware.vt.edu ${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    ldapProvider="org.ldaptive.provider.jndi.JndiProvider"
    connectionStrategy="RANDOM"
    hostnameVerifier="org.ldaptive.ssl.AnyHostnameVerifier{foo=test,bar=false}"
    setLdapDnPrincipal="true"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    userFilter="(mail={0})"
    userRoleAttribute="departmentNumber"
    sslSocketFactory="{trustCertificates=file:target/test-classes/ldaptive.trust.crt}";
};

ldaptive-roles {
  org.ldaptive.jaas.LdapLoginModule required
    storePass="true"
    ldapUrl="${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    hostnameVerifier="org.ldaptive.ssl.AnyHostnameVerifier"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    userFilter="(mail={0})"
    userRoleAttribute="departmentNumber"
    sslSocketFactory="{org.ldaptive.ssl.KeyStoreCredentialConfig{{trustStore=classpath:/ldaptive.truststore} {trustStoreType=BKS}}}";
  org.ldaptive.jaas.LdapRoleAuthorizationModule optional
    useFirstPass="true"
    ldapUrl="${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    roleFilter="(mail={1})"
    roleAttribute="objectClass"
    sslSocketFactory="{org.ldaptive.ssl.KeyStoreCredentialConfig{{trustStore=classpath:/ldaptive.truststore} {trustStoreType=BKS}}}";
};

ldaptive-roles-recursive {
  org.ldaptive.jaas.LdapLoginModule required
    storePass="true"
    ldapUrl="${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    userFilter="(mail={0})"
    userRoleAttribute="departmentNumber"
    sslSocketFactory="{org.ldaptive.ssl.KeyStoreCredentialConfig{{trustStore=classpath:/ldaptive.truststore} {trustStoreType=BKS}}}";
  org.ldaptive.jaas.LdapRoleAuthorizationModule required
    useFirstPass="true"
    ldapUrl="${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    roleFilter="(member={0})"
    roleAttribute="uugid"
    ldapEntryHandlers="org.ldaptive.handler.RecursiveEntryHandler{{searchAttribute=member}{mergeAttributes=uugid}}"
    sslSocketFactory="{org.ldaptive.ssl.KeyStoreCredentialConfig{{trustStore=classpath:/ldaptive.truststore} {trustStoreType=BKS}}}";
};

ldaptive-use-first {
  org.ldaptive.jaas.TestLoginModule required;
  org.ldaptive.jaas.LdapLoginModule required
    useFirstPass="true"
    ldapUrl="${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    userFilter="(mail={0})"
    userRoleAttribute="departmentNumber"
    defaultRole="test-role1,test-role2"
    sslSocketFactory="org.ldaptive.ssl.TLSSocketFactory{org.ldaptive.ssl.KeyStoreCredentialConfig{{trustStore=classpath:/ldaptive.truststore} {trustStoreType=BKS}}}";
};

ldaptive-try-first {
  org.ldaptive.jaas.TestLoginModule required;
  org.ldaptive.jaas.LdapLoginModule required
    tryFirstPass="true"
    storePass="true"
    ldapUrl="${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    userFilter="(mail={0})"
    userRoleAttribute="departmentNumber"
    sslSocketFactory="org.ldaptive.ssl.TLSSocketFactory{org.ldaptive.ssl.KeyStoreCredentialConfig{{trustStore=classpath:/ldaptive.truststore} {trustStoreType=BKS}}}";
  org.ldaptive.jaas.LdapRoleAuthorizationModule optional
    useFirstPass="true"
    ldapUrl="${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    roleFilter="(mail={1})"
    roleAttribute="objectClass"
    sslSocketFactory="org.ldaptive.ssl.TLSSocketFactory{org.ldaptive.ssl.KeyStoreCredentialConfig{{trustStore=classpath:/ldaptive.truststore} {trustStoreType=BKS}}}";
};

ldaptive-sufficient {
  org.ldaptive.jaas.LdapLoginModule sufficient
    ldapUrl="${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    userFilter="(mail={0})"
    userRoleAttribute="departmentNumber"
    sslSocketFactory="org.ldaptive.ssl.TLSSocketFactory{org.ldaptive.ssl.KeyStoreCredentialConfig{{trustStore=classpath:/ldaptive.truststore} {trustStoreType=BKS}}}";
  org.ldaptive.jaas.LdapLoginModule sufficient
    ldapUrl="${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    userFilter="(mail={0})"
    userRoleAttribute="departmentNumber"
    sslSocketFactory="org.ldaptive.ssl.TLSSocketFactory{org.ldaptive.ssl.KeyStoreCredentialConfig{{trustStore=classpath:/ldaptive.truststore} {trustStoreType=BKS}}}";
};

ldaptive-roles-only {
  org.ldaptive.jaas.LdapRoleAuthorizationModule required
    useFirstPass="true"
    ldapUrl="${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    roleFilter="(uid=10)"
    roleAttribute="departmentNumber,objectClass"
    principalGroupName="Principals"
    roleGroupName="Roles"
    sslSocketFactory="org.ldaptive.ssl.TLSSocketFactory{org.ldaptive.ssl.KeyStoreCredentialConfig{{trustStore=classpath:/ldaptive.truststore} {trustStoreType=BKS}}}";
};

ldaptive-dn-roles-only {
  org.ldaptive.jaas.LdapDnAuthorizationModule required
    storePass="true"
    ldapUrl="${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    userFilter="(mail={0})"
    sslSocketFactory="org.ldaptive.ssl.TLSSocketFactory{org.ldaptive.ssl.KeyStoreCredentialConfig{{trustStore=classpath:/ldaptive.truststore} {trustStoreType=BKS}}}";
  org.ldaptive.jaas.LdapRoleAuthorizationModule required
    useFirstPass="true"
    ldapUrl="${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    roleFilter="(mail={1})"
    roleAttribute="departmentNumber,objectClass"
    principalGroupName="Principals"
    roleGroupName="Roles"
    sslSocketFactory="org.ldaptive.ssl.TLSSocketFactory{org.ldaptive.ssl.KeyStoreCredentialConfig{{trustStore=classpath:/ldaptive.truststore} {trustStoreType=BKS}}}";
};

ldaptive-roles-only-pooled {
  org.ldaptive.jaas.LdapRoleAuthorizationModule required
    useFirstPass="true"
    ldapUrl="${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    roleFilter="(uid=10)"
    roleAttribute="departmentNumber,objectClass"
    principalGroupName="Principals"
    roleGroupName="Roles"
    roleResolver="org.ldaptive.jaas.PooledSearchRoleResolver"
    cacheId="ldaptive-roles-only-pooled"
    sslSocketFactory="org.ldaptive.ssl.TLSSocketFactory{org.ldaptive.ssl.KeyStoreCredentialConfig{{trustStore=classpath:/ldaptive.truststore} {trustStoreType=BKS}}}";
};

ldaptive-pooled-dnr {
  org.ldaptive.jaas.LdapLoginModule required
    ldapUrl="${ldapTestHost}"
    baseDn="ou=test,dc=vt,dc=edu"
    tls="true"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    userFilter="(&(mail={0})(objectClass={1}))"
    userFilterArgs="person"
    dnResolver="org.ldaptive.auth.PooledSearchDnResolver"
    authenticationHandler="org.ldaptive.auth.PooledBindAuthenticationHandler"
    cacheId="ldaptive-pooled-dnr"
    sslSocketFactory="{org.ldaptive.ssl.KeyStoreCredentialConfig{{trustStore=classpath:/ldaptive.truststore} {trustStoreType=BKS}}}";
};

ldaptive-pooled-dnr-spring {
  org.ldaptive.jaas.LdapLoginModule required
    authenticatorFactory="org.ldaptive.jaas.SpringAuthenticatorFactory";
};

ldaptive-props {
  org.ldaptive.jaas.PropsLoginModule required
    ldapProvider="org.ldaptive.provider.jndi.JndiProvider"
    ldapUrl="${ldapTestHost}"
    bindDn="uid=1,ou=test,dc=vt,dc=edu"
    bindCredential="VKSxXwlU7YssGl1foLMH2mGMWkifbODb1djfJ4t2"
    connectTimeout="8000"
    tls="true"
    java.naming.authoritative="true"
    baseDn="ou=test,dc=vt,dc=edu"
    searchScope="OBJECT"
    timeLimit="5000"
    binaryAttributes="jpegPhoto"
    operationRetry="7"
    operationRetryWait="2000"
    operationRetryBackoff="3"
    ldapEntryHandlers="org.ldaptive.handler.RecursiveEntryHandler{{searchAttribute=member}{mergeAttributes=mail,department}},org.ldaptive.handler.MergeAttributeEntryHandler{ }"
    authenticationHandler="org.ldaptive.auth.CompareAuthenticationHandler"
    dnResolver="org.ldaptive.auth.PooledSearchDnResolver"
    hostnameVerifier="org.ldaptive.ssl.AnyHostnameVerifier"
    setLdapDnPrincipal="true"
    userFilter="(mail={0})"
    userRoleAttribute="departmentNumber"
    sslSocketFactory="{trustCertificates=file:target/test-classes/ldaptive.trust.crt}";
};

com.sun.security.jgss.initiate {
  com.sun.security.auth.module.Krb5LoginModule required
    doNotPrompt="true"
    debug="true"
    principal="test3"
    useKeyTab="true"
    keyTab="target/test-classes/krb5.keytab";
};

GSSAPIBindRequest {
  com.sun.security.auth.module.Krb5LoginModule required
    doNotPrompt="true"
    debug="true"
    principal="test3"
    useKeyTab="true"
    keyTab="target/test-classes/krb5.keytab";
};
